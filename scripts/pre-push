#!/bin/bash

ISSUES="no"

SCRIPT_DIR=$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )

for FILE in `git diff-index --name-only master`; do
  # do not check files others than *.py
  if [[ $FILE == *.py ]]; then
    if ! flake8 --config $SCRIPT_DIR/../.flake8 $FILE; then
        ISSUES="yes"
    fi
  fi
done;

if [[ $ISSUES == "no" ]]; then
    exit 0
else
    echo "Please resolve linting issues";
    exit 1
fi
